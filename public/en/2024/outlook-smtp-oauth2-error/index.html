<!DOCTYPE html>
<html lang="en">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='In this blog, I used Outlook&#39;s SMTP service when accessing email alerts in the comment system, but I found an error when using it.'><title>Outlook Smtp Oauth2 Error</title>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8353154221194666"
     crossorigin="anonymous"></script>
     
<link rel='canonical' href='http://localhost:1313/en/2024/outlook-smtp-oauth2-error/'>

<link rel="stylesheet" href="/scss/style.min.6178df861af1267c46fa69ff3236a16b81dd938662a9eb5ef988db4f5e2ffbb9.css"><meta property="og:title" content="Outlook Smtp Oauth2 Error" />
<meta property="og:description" content="In this blog, I used Outlook&#39;s SMTP service when accessing email alerts in the comment system, but I found an error when using it." />
<meta property="og:url" content="http://localhost:1313/en/2024/outlook-smtp-oauth2-error/" />
<meta property="og:site_name" content="Cai Hong Tu&#39;s Blog" />
<meta
  property="og:type"
  content="article"
/><meta property="article:section" content="Post" /><meta property="article:tag" content="outlook" /><meta property="article:tag" content="smtp" /><meta
  property="article:published_time"
  content='2024-11-15T22:57:15&#43;08:00'
/><meta
  property="article:modified_time"
  content='2024-11-16T12:01:49&#43;08:00'
/><meta property="og:image" content="https://picsum.photos/seed/34535s/800/600" />
<meta name="twitter:title" content="Outlook Smtp Oauth2 Error">
<meta name="twitter:description" content="In this blog, I used Outlook&#39;s SMTP service when accessing email alerts in the comment system, but I found an error when using it."><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://picsum.photos/seed/34535s/800/600' />
    <link rel="shortcut icon" href="/img/favicon.ico" />
<style>
    :root {
        --article-font-family: "Noto Serif SC", var(--base-font-family);
    }
</style>

<script> 
		(function () {
		    const customFont = document.createElement('link');
		    customFont.href = "https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@300;700&display=swap"; 
		    customFont.type = "text/css";
		    customFont.rel = "stylesheet";
		
		    document.head.appendChild(customFont);
		}());
</script>

    </head>
    <body class="
    article-page
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    <!-- 
        extended
     -->
    on-phone--column extended
">
    
        <div id="article-toolbar" style="display: flex;position: sticky;top: 5px;z-index: 1000;">
            <a href="http://localhost:1313/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>Back</span>
            </a>
        </div>
    

    

<main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/en/2024/outlook-smtp-oauth2-error/">
                
                    <img src="https://picsum.photos/seed/34535s/800/600" loading="lazy" alt="Featured image of post Outlook Smtp Oauth2 Error" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/en/categories/email/" style="background-color: #3a2d8f; color: #fff;">
                Email
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/en/2024/outlook-smtp-oauth2-error/">Outlook Smtp Oauth2 Error</a>
    </h2>

    
    <h3 class="article-subtitle">
        In this blog, I used Outlook&#39;s SMTP service when accessing email alerts in the comment system, but I found an error when using it.
    </h3>
    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Nov 15, 2024</time>
            </div>
        
    
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-words">
                    
                    约3分钟，共509字
                </time>
            </div>
        
    
        <div>
            <?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1731571978497" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4337" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24"><path d="M512 195.047619c150.79619 0 288.280381 92.013714 412.42819 276.041143a73.142857 73.142857 0 0 1 2.755048 77.385143l-2.755048 4.437333-6.92419 10.118095C795.184762 740.303238 659.992381 828.952381 512 828.952381c-150.79619 0-288.280381-92.013714-412.42819-276.041143a73.142857 73.142857 0 0 1-2.755048-77.385143l2.755048-4.437333 6.92419-10.118095C228.815238 283.696762 364.007619 195.047619 512 195.047619z m0 73.142857c-120.880762 0-235.471238 75.142095-345.088 234.008381L160.207238 512l6.729143 9.825524C276.650667 680.740571 391.216762 755.809524 512 755.809524c120.880762 0 235.471238-75.142095 345.088-234.008381l6.704762-9.801143-6.729143-9.825524C747.349333 343.259429 632.783238 268.190476 512 268.190476z m0 88.551619a161.694476 161.694476 0 1 1 0 323.364572 161.694476 161.694476 0 0 1 0-323.364572z m0 73.142857a88.551619 88.551619 0 1 0 0 177.078858 88.551619 88.551619 0 0 0 0-177.078858z" p-id="4338" fill="currentColor"></path></svg>
            <time class="article-pageview">
                <span class="waline-pageview-count" data-path="/en/2024/outlook-smtp-oauth2-error/">0</span> 次浏览
            </time>
        </div>
    
        <div>
            <?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1731571999261" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5443" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24"><path d="M853.333333 138.666667H170.666667c-40.533333 0-74.666667 34.133333-74.666667 74.666666v512c0 40.533333 34.133333 74.666667 74.666667 74.666667h151.466666V917.333333c0 12.8 8.533333 25.6 19.2 29.866667 4.266667 2.133333 8.533333 2.133333 12.8 2.133333 8.533333 0 17.066667-4.266667 23.466667-10.666666l136.533333-138.666667H853.333333c40.533333 0 74.666667-34.133333 74.666667-74.666667V213.333333c0-40.533333-34.133333-74.666667-74.666667-74.666666z m10.666667 586.666666c0 6.4-4.266667 10.666667-10.666667 10.666667H501.333333c-8.533333 0-17.066667 4.266667-23.466666 10.666667l-89.6 93.866666V768c0-17.066667-14.933333-32-32-32H170.666667c-6.4 0-10.666667-4.266667-10.666667-10.666667V213.333333c0-6.4 4.266667-10.666667 10.666667-10.666666h682.666666c6.4 0 10.666667 4.266667 10.666667 10.666666v512z" fill="currentColor" p-id="5444"></path><path d="M512 490.666667H298.666667c-17.066667 0-32 14.933333-32 32S281.6 554.666667 298.666667 554.666667h213.333333c17.066667 0 32-14.933333 32-32S529.066667 490.666667 512 490.666667zM672 341.333333H298.666667c-17.066667 0-32 14.933333-32 32S281.6 405.333333 298.666667 405.333333h373.333333c17.066667 0 32-14.933333 32-32s-14.933333-32-32-32z" fill="currentColor" p-id="5445"></path></svg>
            <time class="article-comment">
                <span class="waline-comment-count" data-path="/en/2024/outlook-smtp-oauth2-error/">0</span> 条评论
            </time>
        </div>

        <div>
            
            
            
            
                
                
                    
                        
                        
                            <time class="article-comment">
                                <li id="selected"><?xml version="1.0" encoding="utf-8"?>
<!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->
<svg fill="currentColor" height="24px" width="24px" version="1.1" id="anna_vital_language_icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
	  viewBox="0 0 256 256" enable-background="new 0 0 256 256" xml:space="preserve">
<path d="M62.4,101c-1.5-2.1-2.1-3.4-1.8-3.9c0.2-0.5,1.6-0.7,3.9-0.5c2.3,0.2,4.2,0.5,5.8,0.9c1.5,0.4,2.8,1,3.8,1.7
	c1,0.7,1.8,1.5,2.3,2.6c0.6,1,1,2.3,1.4,3.7c0.7,2.8,0.5,4.7-0.5,5.7c-1.1,1-2.6,0.8-4.6-0.6c-2.1-1.4-3.9-2.8-5.5-4.2
	C65.5,105.1,63.9,103.2,62.4,101z M40.7,190.1c4.8-2.1,9-4.2,12.6-6.4c3.5-2.1,6.6-4.4,9.3-6.8c2.6-2.3,5-4.9,7-7.7
	c2-2.7,3.8-5.8,5.4-9.2c1.3,1.2,2.5,2.4,3.8,3.5c1.2,1.1,2.5,2.2,3.8,3.4c1.3,1.2,2.8,2.4,4.3,3.8c1.5,1.4,3.3,2.8,5.3,4.5
	c0.7,0.5,1.4,0.9,2.1,1c0.7,0.1,1.7,0,3.1-0.6c1.3-0.5,3-1.4,5.1-2.8c2.1-1.3,4.7-3.1,7.9-5.4c1.6-1.1,2.4-2,2.3-2.7
	c-0.1-0.7-1-1-2.7-0.9c-3.1,0.1-5.9,0.1-8.3-0.1c-2.5-0.2-5-0.6-7.4-1.4c-2.4-0.8-4.9-1.9-7.5-3.4c-2.6-1.5-5.6-3.6-9.1-6.2
	c1-3.9,1.8-8,2.4-12.4c0.3-2.5,0.6-4.3,0.8-5.6c0.2-1.2,0.5-2.4,0.9-3.3c0.3-0.8,0.4-1.4,0.5-1.9c0.1-0.5-0.1-1-0.4-1.6
	c-0.4-0.5-1-1.1-1.9-1.7c-0.9-0.6-2.2-1.4-3.9-2.3c2.4-0.9,5.1-1.7,7.9-2.6c2.7-0.9,5.7-1.8,8.8-2.7c3-0.9,4.5-1.9,4.6-3.1
	c0.1-1.2-0.9-2.3-3.2-3.5c-1.5-0.8-2.9-1.1-4.3-0.9c-1.4,0.2-3.2,0.9-5.4,2.2c-0.6,0.4-1.8,0.9-3.4,1.6c-1.7,0.7-3.6,1.5-6,2.5
	c-2.4,1-5,2-7.8,3.1c-2.9,1.1-5.8,2.2-8.7,3.2c-2.9,1.1-5.7,2-8.2,2.8c-2.6,0.8-4.6,1.4-6.1,1.6c-3.8,0.8-5.8,1.6-5.9,2.4
	c0,0.8,1.5,1.6,4.4,2.4c1.2,0.3,2.3,0.6,3.1,0.6c0.8,0.1,1.7,0.1,2.5,0c0.8-0.1,1.6-0.3,2.4-0.5c0.8-0.3,1.7-0.7,2.8-1.1
	c1.6-0.8,3.9-1.7,6.9-2.8c2.9-1,6.6-2.4,11.2-4c0.9,2.7,1.4,6,1.4,9.8c0,3.8-0.4,8.1-1.4,13c-1.3-1.1-2.7-2.3-4.2-3.6
	c-1.5-1.3-2.9-2.6-4.3-3.9c-1.6-1.5-3.2-2.5-4.7-3c-1.6-0.5-3.4-0.5-5.5,0c-3.3,0.9-5,1.9-4.9,3.1c0,1.2,1.3,1.8,3.8,1.9
	c0.9,0.1,1.8,0.3,2.7,0.6c0.9,0.3,1.9,0.9,3.2,1.8c1.3,0.9,2.9,2.2,4.7,3.8c1.8,1.6,4.2,3.7,7,6.3c-1.2,2.9-2.6,5.6-4.1,8
	c-1.5,2.5-3.4,5-5.5,7.3c-2.2,2.4-4.7,4.8-7.7,7.2c-3,2.5-6.6,5.1-10.8,7.8c-4.3,2.8-6.5,4.7-6.5,5.6C35,192.1,37,191.7,40.7,190.1z
	 M250.5,81.8v165.3l-111.6-36.4L10.5,253.4V76.1l29.9-10V10.4l81.2,28.7L231.3,2.6v73.1L250.5,81.8z M124.2,50.6L22.3,84.6v152.2
	l101.9-33.9V50.6L124.2,50.6z M219.4,71.9V19L138.1,46L219.4,71.9z M227,201.9L196.5,92L176,85.6l-30.9,90.8l18.9,5.9l5.8-18.7
	l31.9,10l5.7,22.3L227,201.9z M174.8,147.7l22.2,6.9l-10.9-42.9L174.8,147.7z"/>
</svg><a href="/2024/outlook-smtp-oauth2-error/"><span>简体中文</span></a></li>
                            </time>
                        
                    
                
                    
                
            
                
                
                    
                
                    
                        
                        
                        
                    
                
            
            
        </div>
    </footer>
    
    
</div>
</header>

    <section class="article-content">
    
    
    <h2 id="introduction">Introduction</h2>
<p>When the comment system of this blog was connected to the email reminder, the SMTP service of Outlook was used, but when using it, it was found that there was no email reminder.</p>
<h2 id="view-the-log">View the log</h2>
<p>So I went to Vercel to check the log, as shown below:</p>
<p><figure 
	>
	<a href="https://s2.loli.net/2024/11/15/wl5o4EAj2GBv3sI.png" >
		<img src="https://s2.loli.net/2024/11/15/wl5o4EAj2GBv3sI.png"
			
			
			
			loading="lazy"
			alt="Walline project deployed by Vercel - Sending email reminder error">
	</a>
	
	<figcaption>Walline project deployed by Vercel - Sending email reminder error</figcaption>
	
</figure></p>
<p>The error stack is as follows:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">Mail</span> <span class="n">send</span> <span class="n">fail</span><span class="p">:</span> <span class="n">Error</span><span class="p">:</span> <span class="n">Invalid</span> <span class="n">login</span><span class="p">:</span> <span class="mi">535</span> <span class="mf">5.7</span><span class="o">.</span><span class="mi">139</span> <span class="n">Authentication</span> <span class="n">unsuccessful</span><span class="p">,</span> <span class="n">basic</span> <span class="n">authentication</span> <span class="n">is</span> <span class="n">disabled</span><span class="o">.</span> <span class="p">[</span><span class="n">CH0PR13CA0024</span><span class="o">.</span><span class="n">namprd13</span><span class="o">.</span><span class="n">prod</span><span class="o">.</span><span class="n">outlook</span><span class="o">.</span><span class="n">com</span> <span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">15</span><span class="n">T12</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mf">27.364</span><span class="n">Z</span> <span class="mi">08</span><span class="n">DD02E8CBA00082</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">SMTPConnection</span><span class="o">.</span><span class="n">_formatError</span> <span class="p">(</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">task</span><span class="o">/</span><span class="n">node_modules</span><span class="o">/</span><span class="n">nodemailer</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">smtp</span><span class="o">-</span><span class="n">connection</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">js</span><span class="p">:</span><span class="mi">807</span><span class="p">:</span><span class="mi">19</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">SMTPConnection</span><span class="o">.</span><span class="n">_actionAUTHComplete</span> <span class="p">(</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">task</span><span class="o">/</span><span class="n">node_modules</span><span class="o">/</span><span class="n">nodemailer</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">smtp</span><span class="o">-</span><span class="n">connection</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">js</span><span class="p">:</span><span class="mi">1586</span><span class="p">:</span><span class="mi">34</span><span class="p">)</span> <span class="n">at</span> <span class="n">SMTPConnection</span><span class="o">.&lt;</span><span class="n">anonymous</span><span class="o">&gt;</span> <span class="p">(</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">task</span><span class="o">/</span><span class="n">node_modules</span><span class="o">/</span><span class="n">nodemailer</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">smtp</span><span class="o">-</span><span class="n">connection</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">js</span><span class="p">:</span><span class="mi">1540</span><span class="p">:</span><span class="mi">18</span><span class="p">)</span> <span class="n">at</span> <span class="n">SMTPConnection</span><span class="o">.</span><span class="n">_processResponse</span> <span class="p">(</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">task</span> <span class="o">/</span><span class="n">node_modules</span><span class="o">/</span><span class="n">nodemailer</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">smtp</span><span class="o">-</span><span class="n">connection</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">js</span><span class="p">:</span><span class="mi">991</span><span class="p">:</span><span class="mi">20</span><span class="p">)</span> <span class="n">at</span> <span class="n">SMTPConnection</span><span class="o">.</span><span class="n">_onData</span> <span class="p">(</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">task</span><span class="o">/</span><span class="n">node_modules</span><span class="o">/</span><span class="n">nodemailer</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">smtp</span><span class="o">-</span><span class="n">connection</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">js</span><span class="p">:</span><span class="mi">772</span><span class="p">:</span><span class="mi">14</span><span class="p">)</span> <span class="n">at</span> <span class="n">TLSSocket</span><span class="o">.</span><span class="n">SMTPConnection</span><span class="o">.</span><span class="n">_onSocketData</span> <span class="p">(</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">task</span><span class="o">/</span><span class="n">node_modules</span><span class="o">/</span><span class="n">nodemailer</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">smtp</span><span class="o">-</span><span class="n">connection</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">js</span><span class="p">:</span><span class="mi">195</span><span class="p">:</span><span class="mi">44</span><span class="p">)</span> <span class="n">at</span> <span class="n">TLSSocket</span><span class="o">.</span><span class="n">emit</span> <span class="p">(</span><span class="n">node</span><span class="p">:</span><span class="n">events</span><span class="p">:</span><span class="mi">519</span><span class="p">:</span><span class="mi">28</span><span class="p">)</span> <span class="n">at</span> <span class="n">TLSSocket</span><span class="o">.</span><span class="n">emit</span> <span class="p">(</span><span class="n">node</span><span class="p">:</span><span class="n">domain</span><span class="p">:</span><span class="mi">488</span><span class="p">:</span><span class="mi">12</span><span class="p">)</span> <span class="n">at</span> <span class="n">addChunk</span> <span class="p">(</span><span class="n">node</span><span class="p">:</span><span class="n">internal</span><span class="o">/</span><span class="n">streams</span><span class="o">/</span><span class="n">readable</span><span class="p">:</span><span class="mi">559</span><span class="p">:</span><span class="mi">12</span><span class="p">)</span> <span class="n">at</span> <span class="n">readableAddChunkPushBy</span> <span class="n">teMode</span> <span class="p">(</span><span class="n">node</span><span class="p">:</span><span class="n">internal</span><span class="o">/</span><span class="n">streams</span><span class="o">/</span><span class="n">readable</span><span class="p">:</span><span class="mi">510</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="p">{</span> <span class="n">code</span><span class="p">:</span> <span class="s1">&#39;EAUTH&#39;</span><span class="p">,</span> <span class="n">response</span><span class="p">:</span> <span class="s1">&#39;535 5.7.139 Authentication unsuccessful, basic authentication is disabled. [CH0PR13CA0024.namprd13.prod.outlook.com 2024-11-15T12:41:27.364Z 08DD02E8CBA00082]&#39;</span><span class="p">,</span> <span class="n">responseCode</span><span class="p">:</span> <span class="mi">535</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="n">command</span><span class="p">:</span> <span class="s1">&#39;AUTH LOGIN&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="source-of-this-article">Source of this article</h2>
<p>No one seems to have raised this question in <a class="link" href="https://github.com/orgs/walinejs/discussions"  target="_blank" rel="noopener"
    >waline&rsquo;s discussions</a>, maybe I&rsquo;m the only one using Outlook&hellip;</p>
<p>Just look at the first line: <code>Mail send fail: Error: Invalid login: 535 5.7.139 Authentication unsuccessful, basic authentication is disabled.</code>, which means that Outlook&rsquo;s SMTP service does not support basic authentication.
I searched and found that Outlook stopped supporting basic authentication for individual users on September 16, 24, and recommended using OAuth2 authentication. <a class="link" href="https://techcommunity.microsoft.com/blog/outlook/keeping-our-outlook-personal-email-users-safe-reinforcing-our-commitment-to-secu/4164184"  target="_blank" rel="noopener"
    >See | Microsoft official website</a>
But I didn&rsquo;t find support for OAuth2 in the <a class="link" href="https://waline.js.org/reference/server/env.html#%e9%82%ae%e4%bb%b6"  target="_blank" rel="noopener"
    >waline document</a>.</p>
<p>Write a plug-in yourself?</p>
<p>It seems unnecessary to write one for a comment system, after all, human energy is limited (~~ I won&rsquo;t say I&rsquo;m a novice~~)</p>
<h2 id="solution">Solution</h2>
<p>So today&rsquo;s protagonist: <a class="link" href="https://sendas.email/"  target="_blank" rel="noopener"
    >sendas.email</a></p>
<p>I will use the project deployed by the author here, and I won&rsquo;t redeploy it again.
If you want to deploy it yourself, you can fork the author&rsquo;s project first, and then deploy it yourself.
The deployment method is as shown below:</p>
<p><figure 
	>
	<a href="https://s2.loli.net/2024/11/16/Z2ROoCiN78X9bcA.jpg" >
		<img src="https://s2.loli.net/2024/11/16/Z2ROoCiN78X9bcA.jpg"
			
			
			
			loading="lazy"
			alt="Deployment method">
	</a>
	
	<figcaption>Deployment method</figcaption>
	
</figure></p>
<h3 id="start-solving">Start solving</h3>
<p>Enter <a class="link" href="https://sendas.email/"  target="_blank" rel="noopener"
    >sendas.email</a>, then scroll down to the bottom and click <code>Sign in with Microsoft</code></p>
<p><figure 
	>
	<a href="https://s2.loli.net/2024/11/16/nvXBIkVYOZ2CSQx.png" >
		<img src="https://s2.loli.net/2024/11/16/nvXBIkVYOZ2CSQx.png"
			
			
			
			loading="lazy"
			alt="Sign in with Microsoft | sendas.email">
	</a>
	
	<figcaption>Sign in with Microsoft | sendas.email</figcaption>
	
</figure></p>
<p>When logging in, Microsoft will prompt you whether to allow third-party applications to access your account. Click <strong>Accept</strong>.</p>
<p><figure 
	>
	<a href="https://s2.loli.net/2024/11/16/5OY3qFZXu2NGvgb.png" >
		<img src="https://s2.loli.net/2024/11/16/5OY3qFZXu2NGvgb.png"
			
			
			
			loading="lazy"
			alt="Authorize">
	</a>
	
	<figcaption>Authorize</figcaption>
	
</figure></p>
<p>After authorization, the Microsoft account team will send an email reminder:</p>
<p><figure 
	>
	<a href="https://s2.loli.net/2024/11/16/SkPVCUp45gBunwI.png" >
		<img src="https://s2.loli.net/2024/11/16/SkPVCUp45gBunwI.png"
			
			
			
			loading="lazy"
			alt="Email reminder">
	</a>
	
	<figcaption>Email reminder</figcaption>
	
</figure></p>
<p>At this time, return to sendas.email, the website automatically redirects to the <a class="link" href="https://sendas.email/configuration"  target="_blank" rel="noopener"
    >configuration page</a>, the page is as shown below:</p>
<p><figure 
	>
	<a href="https://s2.loli.net/2024/11/16/XV5Gr8wY1hdtJ4H.png" >
		<img src="https://s2.loli.net/2024/11/16/XV5Gr8wY1hdtJ4H.png"
			
			
			
			loading="lazy"
			alt="Show new username &#43; password">
	</a>
	
	<figcaption>Show new username + password</figcaption>
	
</figure></p>
<h3 id="modify-environment-variables">Modify environment variables</h3>
<p>Next, return to the deployment of vercel and replace the previous password with the new password.</p>
<p><figure 
	>
	<a href="https://s2.loli.net/2024/11/16/ixrA7yskvpw9H4h.png" >
		<img src="https://s2.loli.net/2024/11/16/ixrA7yskvpw9H4h.png"
			
			
			
			loading="lazy"
			alt="Correspondence">
	</a>
	
	<figcaption>Correspondence</figcaption>
	
</figure></p>
<p>Please note that if you used <code>SMTP_SERVICE</code> before, you need to delete it now and add <code>SMTP_HOST</code> and <code>SMTP_PORT</code>.</p>
<p><figure 
	>
	<a href="https://s2.loli.net/2024/11/16/zxqafYFO6iVjIMR.png" >
		<img src="https://s2.loli.net/2024/11/16/zxqafYFO6iVjIMR.png"
			
			
			
			loading="lazy"
			alt="SMTP_SERVICE is used">
	</a>
	
	<figcaption>SMTP_SERVICE is used</figcaption>
	
</figure></p>
<p>Complete the environment variable configuration of vercel, as shown below:</p>
<p><figure 
	>
	<a href="https://s2.loli.net/2024/11/16/aHElFG3j1M6XZwC.png" >
		<img src="https://s2.loli.net/2024/11/16/aHElFG3j1M6XZwC.png"
			
			
			
			loading="lazy"
			alt="Email configuration">
	</a>
	
	<figcaption>Email configuration</figcaption>
	
</figure></p>
<p>Restart the project, and then you can send emails normally.</p>
<p><figure 
	>
	<a href="https://s2.loli.net/2024/11/16/vncROktPExoCH8h.png" >
		<img src="https://s2.loli.net/2024/11/16/vncROktPExoCH8h.png"
			
			
			
			loading="lazy"
			alt="Restart the project">
	</a>
	
	<figcaption>Restart the project</figcaption>
	
</figure></p>
<h2 id="appendix">Appendix</h2>
<h3 id="reference">Reference</h3>
<ul>
<li><a class="link" href="https://github.com/orgs/walinejs/discussions"  target="_blank" rel="noopener"
    >waline discussions | Github</a></li>
<li><a class="link" href="https://sendas.email/"  target="_blank" rel="noopener"
    >sendas.email | This time&rsquo;s protagonist (this target)</a></li>
<li><a class="link" href="https://github.com/jasperchan/gmail-to-outlook-proxy"  target="_blank" rel="noopener"
    >Gmail-to-outlook-proxy | Github</a></li>
<li><a class="link" href="https://support.google.com/mail/thread/298145809/outlook-smtp-authentication-errors?hl=en"  target="_blank" rel="noopener"
    >Gmail Help | Google Mail Community</a></li>
<li><a class="link" href="https://techcommunity.microsoft.com/blog/outlook/keeping-our-outlook-personal-email-users-safe-reinforcing-our-commitment-to-secu/4164184"  target="_blank" rel="noopener"
    >Update Policy | Microsoft Official website</a></li>
<li><a class="link" href="https://support.microsoft.com/en-us/office/pop-imap-and-smtp-settings-for-outlook-com-d088b986-291d-42b8-9564-9c414e2aa040"  target="_blank" rel="noopener"
    >Wrong Microsoft credentials | Microsoft</a></li>
</ul>
<h3 id="copyright-information">Copyright information</h3>
<p>This article was originally published on <a class="link" href="https://cai-hong-tu-blog.pages.dev/"  target="_blank" rel="noopener"
    >CaiHongTu Blog</a>, following the CC BY-NC-SA 4.0 agreement, please keep the original source when copying.</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/en/tags/outlook/">Outlook</a>
        
            <a href="/en/tags/smtp/">Smtp</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    <section class="article-lastmod">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <span>
            Last updated on Nov 16, 2024 12:01 CST
        </span>
    </section></footer>


    
</article>

    <aside class="related-contents--wrapper">
    
    
</aside>

     
     
        
    <script src='//cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js'></script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v3/dist/waline.css"/>
<div id="waline" class="waline-container"></div>
<style>
    .waline-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
        --waline-font-size: var(--article-font-size);
    }
    .waline-container .wl-count {
        color: var(--card-text-color-main);
    }
</style><script type="module">
    import { init } from 'https://unpkg.com/@waline/client@v3/dist/waline.js';
    init({"comment":true,"dark":"html[data-scheme=\"dark\"]","el":"#waline","emoji":["https://unpkg.com/@waline/emojis@1.2.0/alus","https://unpkg.com/@waline/emojis@1.2.0/soul-emoji","https://unpkg.com/@waline/emojis@1.2.0/tw-emoji","https://unpkg.com/@waline/emojis@1.2.0/bmoji"],"lang":"zh-CN","locale":{"admin":"Blogger","sofa":"No one has commented yet! Come and grab the sofa~"},"pageview":true,"placeholder":"Welcome to leave valuable comments!Please leave a correct email address so that you can receive email reminders when there is a reply. Please do not post any content unrelated to this article.","requiredMeta":["name","email","url"],"serverURL":"https://waline.caihongtu.asia","visitor":true});
</script>

    

    
        <div class="post-reward" data-html2canvas-ignore>
  <input type="checkbox" name="reward" id="reward" hidden />
  <label class="reward-button" for="reward">赞赏支持</label>
  <div class="qr-code">
    
    <label class="qr-code-image" for="reward">
      <img class="image" src="https://s2.loli.net/2024/11/15/qfjwTJbRWVCNugE.jpg" alt="wechat">
      <span>微信打赏</span>
    </label>
    
    
    <label class="qr-code-image" for="reward">
      <img class="image" src="https://s2.loli.net/2024/11/15/iSJ3BIE4uXfsMRe.jpg" alt="alipay">
      <span>支付宝打赏</span>
    </label>
    
    
    <label class="qr-code-image" for="reward">
      <a href="https://paypal.me/wangruntong" target="_blank"><span>Click this to PayPal</span></a>
    </label>
    
  </div>
</div>

    
    
    <footer class="site-footer">
  


    

    

    

    

    

    

    

    


<script>
(function(u, c) {
  var d = document, t = 'script', o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
  o.src = u;
  if (c) { o.addEventListener('load', function(e) { c(e); }); }
  s.parentNode.insertBefore(o, s);
})('//cdn.bootcss.com/pangu/3.3.0/pangu.min.js', function() {
  pangu.spacingPage();
});
</script>

    <section class="copyright">
        &copy; 
        
        2024 <a href="https://stack-theme-mod.vercel.app/">彩虹兔的博客</a>·<i class="fas fa-bell"></i> 网站已平稳运行<a id="days">0</a>天<a id="hours">0</a>小时<a id="minutes">0</a>分<a id="seconds">0</a>秒<br>
      共书写了2.5k字·共 4篇文章·共 <span class="waline-pageview-count" data-path="/">0</span> 次浏览</br><span><p>
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.2.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a><br />
         <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener">© Licensed Under CC BY-NC-SA 4.0</a>
    </section>

<script>
  function updateTime() {
    var s1 = '2024-11-13 14:12:42'; 
    s1 = new Date(s1.replace(/-/g, "/")); 

    var s2 = new Date(); 

    
    var timeDifference = s2.getTime() - s1.getTime();

    
    var number_of_days = Math.floor(timeDifference / (1000 * 60 * 60 * 24));
    var hours = Math.floor((timeDifference % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    var minutes = Math.floor((timeDifference % (1000 * 60 * 60)) / (1000 * 60));
    var seconds = Math.floor((timeDifference % (1000 * 60)) / 1000);

    
    document.getElementById('days').innerHTML = number_of_days;
    document.getElementById('hours').innerHTML = hours;
    document.getElementById('minutes').innerHTML = minutes;
    document.getElementById('seconds').innerHTML = seconds;
}


setInterval(updateTime, 1000);







</script>
    
<script type="module">
  import { pageviewCount } from 'https://unpkg.com/@waline/client@v3/dist/pageview.js';

  pageviewCount({
    serverURL: "https:\/\/waline.caihongtu.asia"
  });
</script>

</footer>



    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">Table of contents</h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ol>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#view-the-log">View the log</a></li>
    <li><a href="#source-of-this-article">Source of this article</a></li>
    <li><a href="#solution">Solution</a>
      <ol>
        <li><a href="#start-solving">Start solving</a></li>
        <li><a href="#modify-environment-variables">Modify environment variables</a></li>
      </ol>
    </li>
    <li><a href="#appendix">Appendix</a>
      <ol>
        <li><a href="#reference">Reference</a></li>
        <li><a href="#copyright-information">Copyright information</a></li>
      </ol>
    </li>
  </ol>
</nav>
                </div>
            </section>
        </aside>
    

    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

<script
    src="https://cdn.jsdelivr.net/gh/zhixuan2333/gh-blog@v0.1.0/js/nprogress.min.js"
    integrity="sha384-bHDlAEUFxsRI7JfULv3DTpL2IXbbgn4JHQJibgo5iiXSK6Iu8muwqHANhun74Cqg"
    crossorigin="anonymous"
></script>
<link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/zhixuan2333/gh-blog@v0.1.0/css/nprogress.css"
    integrity="sha384-KJyhr2syt5+4M9Pz5dipCvTrtvOmLk/olWVdfhAp858UCa64Ia5GFpTN7+G4BWpE"
    crossorigin="anonymous"
/>
<script>
    NProgress.start();
    document.addEventListener("readystatechange", () => {
        if (document.readyState === "interactive") NProgress.inc(0.8);
        if (document.readyState === "complete") NProgress.done();
    });
</script>



        <button type="button" class="btn" onclick="smoothScrollTop()" id="goTopBtn" title="Go to top">TOP</button>
    </body>
    <script>
        
        window.onscroll = function() {scrollTopButton()};

        function scrollTopButton() {
        if (document.body.scrollTop > 50 || document.documentElement.scrollTop > 50) {
            document.getElementById("goTopBtn").style.display = "block";
        } else {
            document.getElementById("goTopBtn").style.display = "none";
        }
        }

        
        function scrollTop() {
        document.body.scrollTop = 0; 
        document.documentElement.scrollTop = 0; 
        }

        
        function smoothScrollTop(){
            var timer  = null;
            cancelAnimationFrame(timer);
            timer = requestAnimationFrame(function fn(){
                var oTop = document.body.scrollTop || document.documentElement.scrollTop;
                if(oTop > 0){
                    document.body.scrollTop = document.documentElement.scrollTop = oTop - 50;
                    timer = requestAnimationFrame(fn);
                }else{
                    cancelAnimationFrame(timer);
                }
            });
        }
    </script>
</html>
